# Anti_Malware
list of anti-malware API

## Index
* [AbuseIPDB](#1-abuseipdb)
* [AlienVault Open Threat Exchange (OTX)](#2-alienvault-open-threat-exchange-otx)
* [Google Safe Browsing](#3-google-safe-browsing)
* [URLScan.io](#4-urlscan)
* [VirusTotal](#5-virustotal)

# 1. [AbuseIPDB](https://docs.abuseipdb.com/)

## __Description__
IP/domain/URL reputation

## __Example Request__
* Curl
```
curl https://api.abuseipdb.com/api/v2/report \
  --data-urlencode "ip=127.0.0.1" \
  -d categories=18,22 \
  --data-urlencode "comment=SSH login attempts with user root." \
  -H "Key: $YOUR_API_KEY" \
  -H "Accept: application/json"
```

* Raw
```
POST /api/v2/report HTTP/1.1
Host: api.abuseipdb.com
Key: $YOUR_API_KEY
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Content-Length: 16

ip=127.0.0.1&categories=18,22&comment=SSH%20login%20attempts%20with%20user%20root.
```

## __Response__
* Success
```
  {
    "data": {
      "ipAddress": "127.0.0.1",
      "abuseConfidenceScore": 52
    }
  }
```
* Error
```
{
    "errors": [{
        "detail": "Authentication failed. Your API key is either missing, incorrect, or revoked. Note: The APIv2 key differs from the APIv1 key.",
        "status": 401
    }]
}
```

## __Regex__
```
[a-z0-9]{80}
```

## __Example API key__
```
c3k69z846qn30q4r6eo3gsg3urqanuoypyluil350m7iyyw55mx6hd22aaa7xj9y0xbk2ygtrcxuzbh8
```

# 2. [AlienVault Open Threat Exchange (OTX)](https://otx.alienvault.com/api)

## __Description__
IP/domain/URL reputation

## __Example Request__
* Curl
```
curl https://otx.alienvault.com/api/v1/pulses/subscribed?page=1 \
-H "X-OTX-API-KEY: YOURAPIKEY"
```

* Raw
```
GET /api/v1/pulses/subscribed?page=1 HTTP/1.1
Host: otx.alienvault.com
X-OTX-API-KEY: YOURAPIKEY
```

## __Response__
* Success
```
{
	"results":[
		{
            "id":"60f1357c15569fb2a28d6d8d",
            "name":"Data-Exfiltrator: A New Tactic for Ransomware Adversaries",
            "description":"Ransomware operators have added a specific type of malware to perform this exfiltration to their intrusion set. The malware follows the exfiltration with a single line PowerShell command that stops the malware's .....
    	}
    ]
}
```
* Error
```
{
    "detail": "Authentication required"
} 
```

## __Regex__
```
[a-z0-9]{64}
```

## __Example API key__
```
n71h0x8j6t2j0ta7omdo9c270jahl20mfu0ttz2is1y4neimis7vhwoh1haf1lti
```

# 3. [Google Safe Browsing](https://developers.google.com/safe-browsing/v4)

## __Description__
Google Link/Domain Flagging

## __Example Request__
* Curl
```
curl --header "Content-Type: application/json" --data "" "https://safebrowsing.googleapis.com/v4/threatListUpdates:fetch?key=API_KEY"
```

* Raw
```
POST /v4/threatListUpdates:fetch?key=API_KEY HTTP/1.1
Host: safebrowsing.googleapis.com
Content-Type: application/json
```

## __Response__
* Success
```
{
	"client": {
    "clientId":       "yourcompanyname",
    "clientVersion":  "1.5.2"
	},
	"listUpdateRequests": [{
		"threatType":      "MALWARE",
		"platformType":    "WINDOWS",
		"threatEntryType": "URL",
		"state":           "Gg4IBBADIgYQgBAiAQEoAQ==",
		"constraints": {
			"maxUpdateEntries":      2048,
			"maxDatabaseEntries":    4096,
			"region":                "US",
			"supportedCompressions": ["RAW"]
			}
		}
	]
}
```
* Error
```
{
    "error": {
        "code": 400,
        "message": "API key not valid. Please pass a valid API key",
        "status": "INVALID_ARGUMENT",                                        "details": [
            {
                "@type": "type.googleapis.com/google.rpc.ErrorInfo",
                "reason": "API_KEY_INVALID","domain": "googleapis.com","metadata": {
                    "service": "safebrowsing.googleapis.com"
                }
            }
        ]
    }
} 
```

## __Regex__
```
AIza[0-9A-Za-z-_]{35}
```

## __Example API key__
```
AIzaSyAtUXpd8JxrpUH2Sd-xO2U_vWGVfoF5-XM
```

# 4. [URLScan](https://urlscan.io/docs/api/)

## __Description__
Scan and Analyse URLs

## __Example Request__
* Curl
```
curl -H "Content-Type: application/json" -H "API-Key: APIKEY" "https://urlscan.io/user/quotas/"
```

* Raw
```
GET /user/quotas/ HTTP/1.1
Host: urlscan.io
Content-Type: application/json
API-Key: APIKEY
```

## __Response__
* Success
```
{
	"source":"user",
	"limits": {
		"private": {
			"day": {
				"limit": 50,
				"used": 0,
				"percent": 0
				}
			//...
```
* Error
```
{
	"message": "API key supplied but not found in database!",
	"status": 401
} 
```

## __Regex__
```
[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}
```

## __Example API key__
```
ptgml8s5-l9r3-6nsg-zv5h-l77q3xa10lu1
```

# 5. [VirusTotal](https://developers.virustotal.com/reference#getting-started)

## __Description__
VirusTotal File/URL Analysis

## __Example Request__
* Curl
```
curl --request POST --url "https://www.virustotal.com/vtapi/v2/url/scan" -d "apikey=APIKEY" --data "url=google.com"
```

* Raw
```
POST /vtapi/v2/url/scan HTTP/1.1
Host: www.virustotal.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 86

apikey=APIKEY&url=google.com
```

## __Response__
* Success
```
{
	"permalink": "https://www.virustotal.com/gui/url/xxxxxx/detection/u-xxxxxxxxxxx-111111111",
	"resource": "http://google.com/",
	"url": "http://google.com/",
	"response_code": 1,
	"scan_date": "2021-08-16 05:56:27",
	"scan_id": "xxxxxxx-11111111",
	"verbose_msg": "Scan request successfully queued, come back later for the report"
}
```
* Error
```

```
>Blank response if error

## __Regex__
```
[a-z0-9]{64}
```

## __Example API key__
```
w5kukcma7yfj8m8p5rkjx5chg3nno9z7h7wr4o8uq1n0pmr5dfejox4oz4xr7g3c
```